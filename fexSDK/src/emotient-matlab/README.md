TODO
============

* Add documentation;
* Add path storing in .file;
* Finish implementing .set;
* Add safe checks (user related);
* Add user test;
* Finish documentation of methods;
* Finish README example;
* Integrate with FEXC.


Emotient Matlab SDK
===========

This [Matlab](http://www.mathworks.com) library wraps the [Emotient Analytics API](https://analytics.emotient.com). This library share some functionality with [emotient-python](https://github.com/emotient/emotient-python).

This library is a sub-module of [fex-metrica](fexmetrica.com), which is a toolbox developed to postprocess facial expression time series detected with systems such as [Emotient Analytics](https://emotient.com).

Project Tree
========

    
    README.md           This file;
    LICENSE.md          MIT license;
    emotient_api.m      Class to interface with Emotient Analytics API;
    include/            Header files and dictionaries;
    users/              Autogenerated folder where user profiles are stored.
    


Installation & Requirements
===========

**Requirements**

The code was developped on OS X. Most functionality will work on Windows as well. However, some methods use unix shell scripting. This code was tested on Matlab v2015a.

=============

**Installation from emotient-matlab repository**

To install this library, go to a terminal and issue the following command:

```
cd some/directory/
git clone https://github.com/filipporss/emotient-matlab.git
cd emotient-matlab && install.sh

```

=============

**Installation with [FexMetrica](fexmetrica.com)**

You can install emotient-matlab from [FexMetrica](fexmetrica.com) by following these [instructions](fexmetrica.com).

=============

**Known Issues**

The class defined in [emotient_api](emotient_api.m) uses Matlab function WEBREAD in order to list and download .csv files from the Emotient website. However both uploading videos and deleting videos from EA server seems to be problematic with Matlab WEBWRITE.

I implemented those operatons with [curl](http://curl.haxx.se). One issue, reported from various sources is that the version of libcurl.4.dylib included in Matlab does not support https. I added a temporary patch, where I temporary change the DYLD_LIBRARY_PATH in order to privilege a different installation of curl and libcurl.


Object Description
===============

The main class used for interfacing with [Emotient Analytics API](https://analytics.emotient.com) is [emotient_api](emotient_api.m). The class can be constructed using the following code:

```Matlab

eam = emotient_api();

```

This creates a default **emotient_api** object, with these properties:


| Property    | Description                              |
|------------ | ---------------------------------------- |
| user        | User name (saved in [users](./users))    |
| media       | List of media file from user's account   |
| report      | String (not used)                        |
| status      | Processing status                        |
| videos      | Videos to upload, download or delete     |
| files       | List of downloaded files                 |
| outdir      | Output directory for .files              |
| page        | Items displayed by page on api           |
| api_base    | 'https://api.emotient.com'               |
| api_version | 1                                        |
| apipath     | Path to 'emotient-matlab'                |
| options     | "WEBOPTION" objects used to define users |


The field **option** is a [WEBOPTIONS](http://www.mathworks.com/help/matlab/ref/weboptions.html) isntance, and it is used to generate a user profile. This property has several options. The ones that can be modified by the user are:


| Fields   | Description         |
| -------- | ------------------- |
| Timeout  | Sec. before timeout |
| Username | User name           |
| Password | Password            |
| KeyValue | Authentication key  |


Quick Example
================

**1. Create a "user" profile**

```Matlab

obj = emotient_api();
obj.set('user','Username','frossi','KeyValue','some-key')

```

The method **.set** allows to add a user profile. Required arguments are 'Username' and 'KeyValue'. The first argument, 'user', tells **.set** which property is being set. When you set a user, a [user].mat file is automatically saved in the directory "users." If you want to use a user profile which already exists, you can construct the **emotient_api** object as follow:

```Matlab

obj = emotient_api('user','frossi');

```

**2. Retrieve your media files**

The property **.media** is originally empty, but you can populate it with uploaded moviea names (i.e. obj.media.videos) and file unique id (i.e. obj.media.id). In order to populate this property, you can use the following code:

```Matlab

obj.list();

```

**3. Select a set of files to download**

After listing all the files in your Emotient directory, you can select to download a subset of them:

```Matlab

% Select output directory
obj.set('outdir','some/output/directory');
% Select a set of videos
use_videos = {'video1.mov','video2.mov', ..., 'videoK.mov'};
obj.set('videos',use_videos);

% Download the videos
obj.grab();

```

If the option property **obj.videos** is empty, all the processed files from yor Emotient account will be downloaded.


**4. Upload new media**

```Matlab

obj.set('videos',use_videos);
obj.send();

```
**5. Delete media files**

```Matlab

obj.clean();

```

================

This code was developped by Filippo Rossi as part of [FexMetrica Toolbox](fexmetrica.com) (contact: fexmetrica@gmail.com). Support for this research was provided by NSF SBE 1232676. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of NSF.

